# 🚢 Titanic生存予測機械学習プロジェクト

## 📋 プロジェクト概要

Titanicデータセットを使用して、乗客の生存を予測する機械学習モデルを作成しました。このプロジェクトでは、データの前処理からモデルの訓練、予測、結果の分析まで、機械学習の全過程を実装しています。

## 🎯 目標

- 乗客の特徴（性別、年齢、客室クラスなど）から生存を予測
- 複数の機械学習アルゴリズムを比較
- 最適なモデルを選択してテストデータで予測
- 提出用のCSVファイルを作成

## 📊 データセット

### 利用可能なファイル
- `train.csv` (891行 × 12列) - 訓練データ
- `test.csv` (418行 × 11列) - テストデータ
- `gender_submission.csv` (418行 × 2列) - サンプル提出ファイル

### データの意味
| カラム名 | 説明 | 値 |
|---------|------|-----|
| Survived | 生存 | 0=死亡, 1=生存 |
| Pclass | 客室クラス | 1=1等客室, 2=2等客室, 3=3等客室 |
| Sex | 性別 | male=男性, female=女性 |
| Age | 年齢 | 数値 |
| SibSp | 兄弟姉妹・配偶者の数 | 数値 |
| Parch | 親・子供の数 | 数値 |
| Fare | 運賃 | 数値 |
| Cabin | 客室番号 | 文字列 |
| Embarked | 乗船港 | C=シェルブール, Q=クイーンズタウン, S=サウサンプトン |
| Ticket | チケット番号 | 文字列 |

## 🔧 データ前処理

### 1. 欠損値の処理
- **年齢**: 中央値で補完
- **運賃**: 中央値で補完（テストデータのみ）
- **乗船港**: 最頻値で補完

### 2. 特徴量エンジニアリング
- **HasCabin**: 客室番号の有無（0/1）
- **FamilySize**: 家族サイズ（SibSp + Parch + 1）
- **IsAlone**: 一人旅かどうか（0/1）
- **AgeGroup**: 年齢グループ（0-4）
- **FareGroup**: 運賃グループ（0-3）
- **Sex_encoded**: 性別のエンコーディング（0=男性, 1=女性）
- **Embarked_encoded**: 乗船港のエンコーディング（0-2）

### 3. 使用する特徴量
最終的に12個の特徴量を使用：
- Pclass, Sex_encoded, Age, SibSp, Parch, Fare
- Embarked_encoded, HasCabin, FamilySize, IsAlone
- AgeGroup, FareGroup

## 🤖 機械学習モデル

### 試行したアルゴリズム
1. **Random Forest** (ランダムフォレスト)
2. **Gradient Boosting** (勾配ブースティング)
3. **Logistic Regression** (ロジスティック回帰)

### モデル比較結果
| モデル | 精度 | クロスバリデーション精度 |
|--------|------|------------------------|
| Random Forest | 79.89% | 81.26% |
| **Gradient Boosting** | **81.01%** | **82.94%** |
| Logistic Regression | 81.01% | 79.46% |

**最良モデル**: Gradient Boosting

## 📈 精度の計測方法

### 1. データ分割
- 訓練データを80%（712件）と20%（179件）に分割
- 80%でモデルを訓練
- 20%で精度を検証

### 2. クロスバリデーション
- 5分割クロスバリデーションを実施
- より信頼性の高い精度評価

### 3. 混同行列
```
予測\実際    死亡  生存
死亡         100    10
生存          24    45
```

### 4. 詳細な分類レポート
- **Precision**: 予測の正確性
- **Recall**: 実際の値の検出率
- **F1-score**: PrecisionとRecallの調和平均

## 🔍 モデル性能の詳細分析

### 性別別の精度
- **男性**: 81.36% (118件中96件正解)
- **女性**: 80.33% (61件中49件正解)

### 客室クラス別の精度
- **1等客室**: 75.56% (45件中34件正解)
- **2等客室**: 88.24% (34件中30件正解)
- **3等客室**: 81.00% (100件中81件正解)

### 正解・不正解の例
**正解例:**
- Davies, Mr. Alfred J (男性, 24歳, 3等客室) → 死亡 (正解)
- Murphy, Miss. Katherine "Kate" (女性, 3等客室) → 生存 (正解)

**不正解例:**
- Leeni, Mr. Fahim (男性, 22歳, 3等客室) → 予測:死亡, 実際:生存
- Butt, Major. Archibald Willingham (男性, 45歳, 1等客室) → 予測:生存, 実際:死亡

## 🔮 テストデータでの予測結果

### 予測概要
- **総乗客数**: 418人
- **生存予測**: 145人 (34.7%)
- **死亡予測**: 273人 (65.3%)

### 性別別予測
- **女性**: 152人中118人を生存と予測 (77.6%)
- **男性**: 266人中17人を生存と予測 (6.4%)

### 客室クラス別予測
- **1等客室**: 107人中61人を生存と予測 (57.0%)
- **2等客室**: 93人中32人を生存と予測 (34.4%)
- **3等客室**: 218人中42人を生存と予測 (19.3%)

### 乗船港別予測
- **シェルブール**: 102人中49人を生存と予測 (48.0%)
- **クイーンズタウン**: 46人中21人を生存と予測 (45.7%)
- **サウサンプトン**: 270人中65人を生存と予測 (24.1%)

## 📁 作成されたファイル

### 1. メインスクリプト
- `create_submission.py` - 機械学習モデルと提出用CSV作成

### 2. 出力ファイル
- `titanic_submission.csv` - 提出用CSVファイル（PassengerId, Survivedのみ）

### 3. ファイル形式
```csv
PassengerId,Survived
892,0
893,0
894,0
...
```

## 🎯 重要な発見

### 1. 生存に影響する要因
- **性別**: 女性の方が生存率が高い
- **客室クラス**: 高級客室の方が生存率が高い
- **年齢**: 子供と高齢者の生存率が比較的高い
- **家族サイズ**: 中程度の家族サイズ（2-4人）が有利
- **乗船港**: シェルブールとクイーンズタウンの方が生存率が高い

### 2. モデルの特徴
- **精度**: 81%という良好な精度を達成
- **安定性**: クロスバリデーションでも82.94%の精度
- **実用性**: 実際の歴史的データと一致する結果

## 🔧 技術的な詳細

### 使用したライブラリ
- **pandas**: データ処理
- **numpy**: 数値計算
- **scikit-learn**: 機械学習アルゴリズム
- **matplotlib/seaborn**: 可視化

### ハイパーパラメータ
- **Gradient Boosting**:
  - n_estimators: 100
  - random_state: 42

### 前処理の手順
1. 欠損値の補完
2. カテゴリカル変数のエンコーディング
3. 新しい特徴量の作成
4. データの正規化

## 📊 結果の解釈

### モデルの信頼性
- 81%の精度は、このような歴史的データセットでは良好
- 性別や客室クラスの影響は歴史的事実と一致
- クロスバリデーションでも安定した性能を示す

### 予測の妥当性
- 女性の生存率が高いという結果は歴史的事実と一致
- 高級客室の生存率が高いという結果も妥当
- 子供の生存率が比較的高いという結果も理解できる

## 🚀 今後の改善点

### 1. 特徴量エンジニアリング
- より詳細な年齢グループの作成
- チケット番号からの情報抽出
- 名前からの敬称（Mr., Mrs., Miss等）の抽出

### 2. モデルの改善
- ハイパーパラメータのチューニング
- アンサンブル手法の使用
- より高度なアルゴリズムの試行

### 3. 評価指標の改善
- ROC-AUCスコアの使用
- より詳細な分類指標の確認

## 📝 結論

このプロジェクトでは、Titanicデータセットを使用して機械学習モデルを構築し、乗客の生存を予測しました。Gradient Boostingアルゴリズムを使用して81%の精度を達成し、歴史的事実と一致する結果を得ることができました。

作成された`titanic_submission.csv`ファイルは、KaggleのTitanicコンペティションに提出できる形式になっており、実用的な機械学習プロジェクトとして完成しています。

---

**作成日**: 2025年8月6日  
**使用技術**: Python, scikit-learn, pandas, numpy  
**精度**: 81.01% (Gradient Boosting) 